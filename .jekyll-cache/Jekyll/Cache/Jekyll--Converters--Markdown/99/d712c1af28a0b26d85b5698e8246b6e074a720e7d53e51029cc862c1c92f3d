I"óO<!-- <span class="tag tag--draft">Not started</span> -->
<!-- <span class="tag tag--progress">In progress</span> -->
<p><span class="tag tag--review">Ready for review</span>
<!-- <span class="tag tag--approved">Approved</span> --></p>

<p class="content__abstract">
  This article tells you how to create one page for each book.
</p>

<p>The portfolio page is looking great. But if you click through on one of the covers, you get a broken page link.</p>

<p><img src="assets/images/broken.png" alt="" /></p>

<p>We need to write code that automatically generates one page per book. If we look back to the Amazon example, earlier, weâ€™ve done the list page and weâ€™re now writing the single-book show page.</p>

<p><img src="assets/images/maps.png" alt="" /></p>

<p>Create a new file in <code class="highlighter-rouge">_layouts</code> called <code class="highlighter-rouge">book_template.html</code>, and make it use the template weâ€™ve used for all the other pages so far by putting the following at the top of the file:</p>

<figure class="highlight"><pre><code class="language-liquid" data-lang="liquid">---
layout: default
---</code></pre></figure>

<p><img src="assets/images/add-book-template.gif" alt="" /></p>

<blockquote>
  <p><span class="content__learn-more">Learn more later</span></p>
  <ul>
    <li>We are using a Jekyll plugin to generate all the pages-per-book. The authors of the plugin have <a href="https://github.com/avillafiorita/jekyll-datapage_gen">written docs</a> which you can read later. Within your codebase, review <code class="highlighter-rouge">_config.yml</code>, where youâ€™ll see the configuration weâ€™ve used, as below, and youâ€™ll see the plugin code itself in the <code class="highlighter-rouge">_plugins/data_page_generator.rb</code>, as instructed in the docs.</li>
  </ul>
</blockquote>

<figure class="highlight"><pre><code class="language-liquid" data-lang="liquid">page_gen-dirs: true
page_gen:
  - data: 'processed_books'
    template: 'book_template'
    name: 'title'
    dir: 'books'</code></pre></figure>

<p>Now if you click through from a cover on the portfolio page, youâ€™ll not get a missing link, but since your <code class="highlighter-rouge">book_template.html</code> page is empty, thereâ€™s not much to see:</p>

<p><img src="assets/images/blank-page.png" alt="" /></p>

<p>Letâ€™s add some code.</p>

<h2 id="build-the-book-template">Build the book template</h2>

<p>Copy and paste the following code into <code class="highlighter-rouge">book_template.html</code> underneath the frontmatter. Weâ€™ve used Ruby programming to transform one type of data into another, and used the Jekyll plug in to load that data into the page, so that the <code class="highlighter-rouge">page</code> variable has methods available on it, provided by our data store, such as <code class="highlighter-rouge">page.title</code>, <code class="highlighter-rouge">page.author</code> and so on.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"header__background--book-page"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h1&gt;</span>â€¢ Coming soon â€¢<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;section</span> <span class="na">class=</span><span class="s">"container__book-page"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"sidebar"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;img</span> <span class="na">class=</span><span class="s">"cover--large"</span> <span class="na">src=</span><span class="s">"{{page.image_path}}"</span> <span class="nt">&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"content"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h1</span> <span class="na">class=</span><span class="s">"book-page"</span><span class="nt">&gt;</span>{{page.title}}<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;h2&gt;</span>{{page.author}}<span class="nt">&lt;/h2&gt;</span>
    <span class="nt">&lt;p&gt;</span>{{page.blurb}}<span class="nt">&lt;/p&gt;</span>
    {% if page.reviews %}
      <span class="nt">&lt;h3&gt;</span>Reviews<span class="nt">&lt;/h3&gt;</span>
      <span class="nt">&lt;p&gt;</span>{{page.reviews}}<span class="nt">&lt;/p&gt;</span>
    {% endif %}
    <span class="nt">&lt;p&gt;</span>
      Published {{page.pub_date | date: "%b %d, %Y"}} â€¢ {{page.page_count}} pages â€¢ {{page.measurements}}mm â€¢
      ISBNs: {{page.isbn}} â€¢ {{ page.isbns | split: " " | join: " â€¢ " }}
    <span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;h4&gt;</span>Buy {{page.title}}<span class="nt">&lt;/h4&gt;</span>
    <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"bookstores-grid"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">target=</span><span class="s">"_blank"</span> <span class="na">href=</span><span class="s">"{{ page.wordery_url}}"</span><span class="nt">&gt;</span>Wordery<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
    <span class="nt">&lt;/ul&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/section&gt;</span></code></pre></figure>

<blockquote>
  <p><span class="content__learn-more">Learn more later</span></p>
  <ul>
    <li>You can see the data weâ€™ve created and are using in <strong>_data/processed_books.json</strong>.</li>
    <li>You can see the code that made it in the <strong>lib</strong> folder.</li>
  </ul>
</blockquote>

<h2 id="add-more-stores">Add more stores</h2>

<p>See if you can add more links to the page to more retailers. The code below will help you.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.waterstones_url}}"</span><span class="nt">&gt;</span>Waterstones<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.foyles_url}}"</span><span class="nt">&gt;</span>Foyles<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.book_depository_url}}"</span><span class="nt">&gt;</span>Book Depository<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.wh_smith_url}}"</span><span class="nt">&gt;</span>WHSmith<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.blackwells_url}}"</span><span class="nt">&gt;</span>Blackwells<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.oxfam_url}}"</span><span class="nt">&gt;</span>Oxfam<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.amz_uk_url}}"</span><span class="nt">&gt;</span>Amazon UK<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.amz_us_url}}"</span><span class="nt">&gt;</span>Amazon US<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.amz_ca_url}}"</span><span class="nt">&gt;</span>Amazon CA<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.amz_de_url}}"</span><span class="nt">&gt;</span>Amazon DE<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.amz_br_url}}"</span><span class="nt">&gt;</span>Amazon BR<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.amz_mx_url}}"</span><span class="nt">&gt;</span>Amazon MX<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.amz_fr_url}}"</span><span class="nt">&gt;</span>Amazon FR<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.amz_es_url}}"</span><span class="nt">&gt;</span>Amazon ES<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.amz_jp_url}}"</span><span class="nt">&gt;</span>Amazon JP<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.amz_in_url}}"</span><span class="nt">&gt;</span>Amazon IN<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.kobo_url}}"</span><span class="nt">&gt;</span>Kobo<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.infini-beam_url}}"</span><span class="nt">&gt;</span>Infinibeam<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.google_play_url}}"</span><span class="nt">&gt;</span>Google Play<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.hive_url}}"</span><span class="nt">&gt;</span>Hive<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.booktopia_url}}"</span><span class="nt">&gt;</span>Booktopia<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.barnes_and_noble_url }}"</span><span class="nt">&gt;</span>Barnes <span class="err">&amp;</span> Noble<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.worldcat_url}}"</span><span class="nt">&gt;</span>Worldcat<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.books_a_million_url}}"</span><span class="nt">&gt;</span>Books A Million<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
<span class="nt">&lt;li&gt;&lt;a</span> <span class="na">class=</span><span class="s">"bookstore"</span> <span class="na">href=</span><span class="s">"{{ page.book_finder_url}}"</span><span class="nt">&gt;</span>Book Finder<span class="nt">&lt;/a&gt;&lt;/li&gt;</span></code></pre></figure>

<h2 id="review-the-pages">Review the pages</h2>

<p>Click through from any cover on the portfolio page and you should now see your book data, one page per book.</p>

<p><img src="assets/images/book-page.png" alt="" /></p>

<p>Click through to see if some of the retailers have your book in stock.</p>

<blockquote>
  <p><span class="content__learn-more">Learn more later</span></p>
  <ul>
    <li>You can improve the SEO of your webpage by including structured data as recommended by Schema.org. Below is some code you can add.</li>
  </ul>
</blockquote>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- add to the top of book_template.html, underneath the front matter --&gt;</span>
{%
  include structuredData.html
  title = page.title
  author = page.author
  isbn = page.isbn
  pub_date = page.pub_date
  usd_price = page.usd_price
  gbp_price = page.gbp_price
  url = page.url
%}

<span class="c">&lt;!-- Add to a new file called structuredData.html, in the _includes folder --&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"application/ld+json"</span><span class="nt">&gt;</span>
<span class="p">{</span>
  <span class="dl">"</span><span class="s2">@context</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">http://schema.org</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">@type</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">Book</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">@id</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">http://silveroakpress.com/{{ include.isbn }}</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">{{ include.title }}</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">author</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">@type</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">Person</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">{{ include.author }}</span><span class="dl">"</span>
  <span class="p">},</span>
  <span class="dl">"</span><span class="s2">url</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">{{ include.url }}</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">workExample</span><span class="dl">"</span> <span class="p">:</span> <span class="p">[{</span>
    <span class="dl">"</span><span class="s2">@type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Book</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">@id</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">http://silveroakpress.com/{{ include.isbn }}</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">isbn</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">{{ include.isbn }}</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">datePublished</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">{{ include.pub_date }}</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">bookFormat</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">http://schema.org/Paperback</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">potentialAction</span><span class="dl">"</span><span class="p">:{</span>
    <span class="dl">"</span><span class="s2">@type</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">ReadAction</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">target</span><span class="dl">"</span><span class="p">:</span>
      <span class="p">{</span>
        <span class="dl">"</span><span class="s2">@type</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">EntryPoint</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">urlTemplate</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">http://www.barnesandnoble.com/s/{{include.isbn}}</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">actionPlatform</span><span class="dl">"</span><span class="p">:[</span>
          <span class="dl">"</span><span class="s2">http://schema.org/DesktopWebPlatform</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">http://schema.org/IOSPlatform</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">http://schema.org/AndroidPlatform</span><span class="dl">"</span>
        <span class="p">]</span>
      <span class="p">},</span>
      <span class="dl">"</span><span class="s2">expectsAcceptanceOf</span><span class="dl">"</span><span class="p">:{</span>
        <span class="dl">"</span><span class="s2">@type</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">Offer</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">Price</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">{{include.usd_price}}</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">priceCurrency</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">USD</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">eligibleRegion</span><span class="dl">"</span> <span class="p">:</span> <span class="p">{</span>
          <span class="dl">"</span><span class="s2">@type</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">Country</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">US</span><span class="dl">"</span>
        <span class="p">},</span>
        <span class="dl">"</span><span class="s2">availability</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">http://schema.org/InStock</span><span class="dl">"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}]</span>
<span class="p">}</span>
<span class="nt">&lt;/script&gt;</span></code></pre></figure>

<h2 id="what-youve-learned">What youâ€™ve learned</h2>

<ul>
  <li>You can use other peopleâ€™s open source code to perform certain tasks, such as generating the static pages</li>
  <li>You call methods on the page variable, which are named using the keys in the JSON data store</li>
</ul>
:ET